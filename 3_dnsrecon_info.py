# Python script to use DnsRecon

# We will use DNSRECON to gather information about the Domains in the local network. This will gather information about the target system and network and trace the ownership of a domain

# Import the necessary library

import subprocess

def dnsrecon(ip_range):
    # Linux command
    command = f"sudo dnsrecon -r {ip_range}"

    try:
        # Run the command and the output
        result = subprocess.run(command, shell=True, capture_output=True, text=True, check=True)

        # Print the output (standart output)
        print(result.stdout)

        return result.stdout

    except subprocess.CalledProcessError as e:
        # Handle error if the dnsrecon command fails
        print(f"Error executing dnsrecon: {e}")
        print(f"Command output:\n{e.stdout.decode()}")
        print(f"Command error:\n{e.stderr.decode()}")

        return None

def write_result(output_file, result):
    with open(output_file, "a") as result_file:
        result_file.write("\nResults from DNSRecon:\n")
        result_file.write(result)

if __name__ == "__main__":
    # Specify the IP range here
    target_ip_range = "192.168.0.0/24"

    output_file = "vulnerability_scanning_results.txt"


    # Call the dnsrecon function with the specified IP range
    result = dnsrecon(target_ip_range)

    write_result(output_file, result)
