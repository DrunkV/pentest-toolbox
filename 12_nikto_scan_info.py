# Python script to run nikto in kali linux. Nikto is a web server scanner to indentify potential vulnerabilitues on a web server.

# Import the necessary libraries

import subprocess
from datetime import datetime

def run_nikto(target_host):
    # Nikto Linux command
    command = f"sudo nikto -h {target_host}"
    try:
        # Run process and capture output
        result = subprocess.run(command, shell=True, capture_output=True, text=True)

        # Print the output
        print(result.stdout)

        return result.stdout

    except subprocess.CalledProcessError as e:
        # Handle erros if the nikto command fails
        print(f"Error executing nikto: {e}")
        print(f"Command output:\n{e.stdout}")
        print(f"Command error;\n{e.stderr}")

        return None

def write_file(output_file, result):
    with open(output_file, "a") as result_file:
        result_file.write("\nNikto scan result:\n")
        if result:
            result_file.write(result)
        else:
            result_file.write("Nikto scan failed:")

if __name__ == "__main__":
    # Target host
    target_host = "192.168.0.2"

    # File name
    output_file = "vulnerability_report.txt"

    # Time
    time = datetime.now()

    # Call the nikto function
    result = run_nikto(target_host)
    write_file(output_file, result)

    # Print information
    print(f"Nikto scan result saved to {output_file} at {time}")



