# Python script to scan the network for live machines using scapy.

# Scapy is a packet manipulation program that allows users to create, manipulate, send dad receive network packets.

# We will send an ARP request (Address Resolution Protocol) to discover MAC addresses.

# Import necessary libraries

import scapy.all as scapy
from scapy.all import ARP, Ether, srp
from datetime import datetime

def arp_scan(target_ip):
    # Create ARP request
    arp_request = Ether(dst="ff:ff:ff:ff:ff:ff") / ARP(pdst=target_ip)

    # Send and receive ARP requests
    result = srp(arp_request, timeout=3, verbose=False)[0]


    # Extract and retunr results
    return [(res[1].psrc, res[1].hwsrc) for res in result]


if __name__ == "__main__":
    # Target IP range
    target_ip = "192.168.0.2/24"


    # Call the arp_scan function
    discovered_hosts = arp_scan(target_ip)

    # Output file
    output_file = "vulnerability_report.txt"

    # Date
    time = datetime.now()

    with open(output_file, "a") as result_file:
        for ip, mac in discovered_hosts:
            result_file.write("\nARP Scan result:\n")
            result_file.write(f"IP: {ip}\tMAC: {mac}\n")

    # Print printing information
    print(f"ARP scan results saved to {output_file} at {time}")



