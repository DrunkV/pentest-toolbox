

from scapy.all import *

def arp_scan(target_ip):
    arp_requests = Ether(dst="ff:ff:ff:ff:ff:ff") / ARP(pdst=target_ip)

    result = srp(arp_requests, timeout=3, verbose=False)[0]

    host = []
    for sent, received in result:
        host.append({'ip': received.psrc, 'mac': received.hwsrc})

    return host

if __name__ == "__main__":
    target_ip_range = "192.168.0.2"

    discovered_hosts = arp_scan(target_ip_range)

    print("Discovered Hosts:")
    for hosts in discovered_hosts:
        print(f"IP: {hosts['ip']}, MAC:{hosts['mac']}")


