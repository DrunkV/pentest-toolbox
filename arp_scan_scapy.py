# Python script to perform a ARP_Scan with Scapy in kali linux

# Import the necessary libraries

from scapy.all import *

def arp_scan(target_ip):
    # Create the ARP request packet
    arp_requests = Ether(dst="ff:ff:ff:ff:ff:ff") / ARP(pdst=target_ip)
    # Send and received the ARP requests
    result = srp(arp_requests, timeout=3, verbose=False)[0]
    
    # Crestes an empty list to store the results
    host = []
    for sent, received in result:
        host.append({'ip': received.psrc, 'mac': received.hwsrc})

    return host

if __name__ == "__main__":
    # Target IP
    target_ip_range = "192.168.0.2"

    # Call the arp_scan function
    discovered_hosts = arp_scan(target_ip_range)

    # Print the results
    print("Discovered Hosts:")
    for hosts in discovered_hosts:
        print(f"IP: {hosts['ip']}, MAC:{hosts['mac']}")


