# Python script to use smbmap in kali linux. SMBMap scanns and enumerates network shares that use Server Message Block (SMB) protocol, commonly used in Windows environments. This tool helps to discover information about network shares and permission.

# Import the necessary library

import subprocess

def run_smbmap(target_ip):
    # SMBMap linux command
    command = f"sudo smbmap -H {target_ip}"

    try:
        # Run the processes and capture the output
        result = subprocess.run(command, shell=True, capture_output=True, text=True, check=True)

        # Print the output
        print(result.stdout)

    except subprocess.CalledProcessError as e:
        # Handle errors if the smbmap command fails
        print(f"Error executing smbmap: {e}")
        print(f"Command output:\n{e.stdout}")
        print(f"Command error:\n{e.stderr}")

if __name__ == "__main__":
    # Target IP
    target_ip = "192.168.0.2"

    # Run the smbap function
    run_smbmap(target_ip)
