# We will use Scapy to scan for open ports in the range of the Nice IP adress
# Scapy is a powerful packet manipulation library for network scanning and analysis. It allows to craft and decode packets.

# Import of necessary library

from scapy.all import *
from datetime import datetime

def port_scan():
    # Target IP
    target_ip = "192.168.0.2"
    # Ports range
    ports_to_scan = range(1, 9999)

    for port in ports_to_scan:
        result = sr1(IP(dst=target_ip) / TCP(dport=port, flags="S"), timeout=1, verbose=0)
        if result and result.haslayer(TCP) and result[TCP].flags == 18:
            print(f"Port {port} is open.")

        return result

def write_result(output_file, results):
    with open(output_file, "a") as result_file:
        result_file.write("\nResults from Port scan:\n")
        result_file.write("\n".join(str(result) for result in results))

output_file = "vulnerability_report.txt"

# Time
time = datetime.now()

# Call port_scan function to run the script
result = port_scan()

write_result(output_file, result)

# Print information
print(f"Port scans saved to {output_file} at {time}")



