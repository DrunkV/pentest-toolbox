# Python script to ICMP ping a host using scapy

# Import the necessary libraries

from scapy.all import *
from datetime import datetime

def icmp_info():
    # Create a packet with a ICMP (Ping) request
    packet = IP(dst="192.168.0.2") / ICMP()
    # Send the packet and received the response
    response = sr1(packet, timeout=2)

    if response:
        response.show()
    else:
        print("No response received")

    return response

# Funciton to write the result to a text file
def write_file(output_file, response):
    with open(output_file, "a") as response_file:
        response_file.write("\nICMP ping result:\n")
        response_file.write(str(response))

# File name
output_file = "vulnerability_report.txt"

# Time
time = datetime.now()

# Call the icmp_info function
response = icmp_info()
write_file(output_file, response)

# Print information
print(f"ICMP Ping result saved to {output_file} at {time}")
