# Python script to crack hashes from metasplotable2 to gain access to passwords and usernames, using John the Ripper


# Import necessary library


import subprocess


def hash_crack():
    # Path to hash file
    hash_file = "/ws/pentest-toolbox/user_hashes.txt"

    # Path to wordlist file
    wordlist_file = "/ws/SecLists/Passwords/xato-net-10-million-passwords.txt"

    # John Linux command
    command = f"sudo john {hash_file} --wordlist={wordlist_file}"

    try:
        # Run the command using subprocess
        process = subprocess.run(command, shell=True, check=True, stdout=subprocess.PIPE, text=True)

        # Print the output of the command
        print(process.stdout)

    except subprocess.CalledProcessError as e:
        # Handle the error if the command fails
        print(f"Error: {e}")
    except Exception as e:
        # Handle other exceptions
        print(f"Unexpected error: {e}")

# Run the hash_crack function
hash_crack()


