# We will use scapy to scan the network


import scapy.all as scapy
from scapy.all import ARP, Ether, srp

def arp_scan(target_ip):
    # Create ARP request
    arp_request = Ether(dst="ff:ff:ff:ff:ff:ff") / ARP(pdst=target_ip)

    # Send and receive ARP requests
    result = srp(arp_request, timeout=3, verbose=False)[0]

    # Process the results
    hosts = []
    for sent, received in result:
        hosts.append({'ip': received.psrc, 'mac': received.hwsrc})

    return hosts

if __name__ == "__main__":
    # Target IP range
    target_ip_range = "192.168.0.1/24"

    # Call the ARP_Scan function
    discovered_hosts = arp_scan(target_ip_range)

    # Print the results
    print("Discovered Hosts:")
    for host in discovered_hosts:
        print(f"IP: {host['ip']}, MAC: {host['mac']}")

